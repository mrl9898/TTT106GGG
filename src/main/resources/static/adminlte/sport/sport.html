<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sportæ¸¬è©¦</title>
</head>
<body>
	<div>Sportæ¸¬è©¦</div>
	<button id="btn_get">æŸ¥è©¢æŒ‰éˆ•</button>
	<button id="btn_insert">æ–°å¢æŒ‰éˆ•</button>
	<br><br>
	<button id="btn_update">æ›´æ–°æŒ‰éˆ•</button>
	<br><br>
	<button id="btn_getByStatus">æŸ¥è©¢statusæŒ‰éˆ•</button>
	<br><br>
	<button id="btn_updateStatus">æ›´æ–°statusæŒ‰éˆ•</button>
	<br><br>
	<button id="btn_insertMultiple">æ–°å¢å¤šç­†æŒ‰éˆ•</button>
	<button id="btn_updateMultiple">æ›´æ–°å¤šç­†æŒ‰éˆ•</button>
	<br><br>
	<button id="btn_getSingle">æŸ¥è©¢ä¸€ç­†æŒ‰éˆ•</button>
	<br><br>

	<!-- ğŸ”½ æ–°å¢ï¼šè¤‡åˆæŸ¥è©¢è¡¨å–® -->
	<h3>è¤‡åˆæŸ¥è©¢è¡¨å–®</h3>
	<form id="complexForm">
		<div>
			<label>é‹å‹•åç¨±/æè¿°(æ¨¡ç³Š)ï¼š</label>
			<input type="text" name="sportNameDescFuzzy" value="è·‘">
		</div>
		<div>
			<label>é‹å‹•ç­‰ç´šï¼š</label>
			<select name="sportLevel">
				<option value="">-- ä¸æŒ‡å®š --</option>
				<option value="junior">åˆéš (beginner)</option>
				<option value="senior">ä¸­éš (intermediate)</option>
				<option value="advanced">é«˜éš (advanced)</option>
			</select>
		</div>
		<div>
			<label>å»ºç«‹èµ·å§‹æ—¥æœŸï¼š</label>
			<input type="date" name="createStartDate">
		</div>
		<div>
			<label>å»ºç«‹çµæŸæ—¥æœŸï¼š</label>
			<input type="date" name="createEndDate">
		</div>
		<div>
			<label>æ›´æ–°èµ·å§‹æ—¥æœŸï¼š</label>
			<input type="date" name="updateStartDate">
		</div>
		<div>
			<label>æ›´æ–°çµæŸæ—¥æœŸï¼š</label>
			<input type="date" name="updateEndDate">
		</div>
		<div>
			<label>ç‹€æ…‹ (å¯å¤šé¸)ï¼š</label><br>
			<select name="statuses" multiple size="3">
				<option value="0" selected>ä¸‹æ¶ (0)</option>
				<option value="1" selected>ä¸Šæ¶ (1)</option>
				<option value="2">åˆªé™¤ (2)</option>
			</select>
		</div>
		<br>
		<button type="submit">é€å‡ºæŸ¥è©¢</button>
	</form>

	<h3>æŸ¥è©¢çµæœ</h3>
	<pre id="result"></pre>

	<script>
		const pathname = window.location.pathname;
		const contextPath = window.location.origin + pathname.substring(0, pathname.lastIndexOf('/') + 1);

		let btnGetEl = document.getElementById("btn_get");
		let btnInsertEl = document.getElementById("btn_insert");
		let btnUpdateEl = document.getElementById("btn_update");
		let btnGetByStatusEl = document.getElementById("btn_getByStatus");
		let btnUpdateStatusEl = document.getElementById("btn_updateStatus");
		let btnInsertMultipleEl = document.getElementById("btn_insertMultiple");
		let btnUpdateMultipleEl = document.getElementById("btn_updateMultiple");
		let btnGetSingleEl = document.getElementById("btn_getSingle");

		async function get() {
			console.log("è§¸ç™¼get");
			let res = await fetch(window.location.origin + "/sport/api/getMultipleAll", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({ hi: "å—¨" })
			});
			let data = await res.json();
			console.log(data);
		}

		async function getSingle() {
			console.log("è§¸ç™¼getSingle");
			let res = await fetch(window.location.origin + "/sport/api/getSingle", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({ sportId: 14 })
			});
			let data = await res.json();
			console.log(data);
		}

		async function getByStatuses() {
			console.log("è§¸ç™¼getByStatuses");
			let res = await fetch(window.location.origin + "/sport/api/getMultipleBySportDataStatuses", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({ statuses: [0, 1] })
			});
			let data = await res.json();
			console.log(data);
		}

		async function insert() {
			console.log("è§¸ç™¼insert");
			let res = await fetch(window.location.origin + "/sport/api/insert", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({
					  sportId: null,
					  sportName: "å“ˆå“ˆå“ˆ",
					  sportDescription: "æ…¢è·‘ 30 åˆ†é˜",
					  sportMets: 8.0,
					  sportEstimatedCalories: 250,
					  sportPic: null,
					  sportDataStatus: 1,
					  adminId: 1
				})
			});
		}

		async function insertMultiple() {
			console.log("è§¸ç™¼insertMultiple");
			let res = await fetch(window.location.origin + "/sport/api/insertMultiple", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({
					sports:[ 
						{
						  sportId: null,
						  sportName: "å“ˆå“ˆå“ˆå’¦",
						  sportDescription: "æ…¢è·‘ 30 åˆ†é˜",
						  sportMets: 8.0,
						  sportEstimatedCalories: 250,
						  sportPic: null,
						  sportDataStatus: 1,
						  adminId: 1
						}
					]
				})
			});
		}

		async function update() {
			console.log("è§¸ç™¼update");
			let res = await fetch(window.location.origin + "/sport/api/update", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({
					  sportId: 13,
					  sportName: "å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ:)",
					  sportDescription: "æ…¢è·‘ 30 åˆ†é˜",
					  sportMets: 8.0,
					  sportEstimatedCalories: 300,
					  sportPic: null,
					  sportDataStatus: 1,
					  adminId: 1
				})
			});
		}

		async function updateMultiple() {
			console.log("è§¸ç™¼updateMultiple");
			let res = await fetch(window.location.origin + "/sport/api/updateMultiple", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({
					sports:[ 
						{
						  sportId: 14,
						  sportName: "å“ˆå“ˆå“ˆXD",
						  sportDescription: "æ…¢è·‘ 30 åˆ†é˜",
						  sportMets: 8.0,
						  sportEstimatedCalories: 250,
						  sportPic: null,
						  sportDataStatus: 1,
						  adminId: 1
						}
					]
				})
			});
		}

		async function updateMultipleSportDataStatus() {
			console.log("è§¸ç™¼updateMultipleSportDataStatus");
			let res = await fetch(window.location.origin + "/sport/api/updateMultipleSportDataStatus", {
				method : "POST",
			    headers: { "Content-Type": "application/json" },
				body : JSON.stringify({
					  sportIds: [14],
					  sportDataStatus: 2
				})
			});
		}

		btnGetEl.addEventListener("click", get);
		btnInsertEl.addEventListener("click", insert);
		btnUpdateEl.addEventListener("click", update);
		btnGetByStatusEl.addEventListener("click", getByStatuses);
		btnUpdateStatusEl.addEventListener("click", updateMultipleSportDataStatus);
		btnInsertMultipleEl.addEventListener("click", insertMultiple);
		btnUpdateMultipleEl.addEventListener("click", updateMultiple);
		btnGetSingleEl.addEventListener("click", getSingle);

		// è¤‡åˆæŸ¥è©¢è¡¨å–®è™•ç†
		const form = document.getElementById("complexForm");
		const resultEl = document.getElementById("result");

		form.addEventListener("submit", async function (e) {
			e.preventDefault();
			const formData = new FormData(form);
			const statuses = formData.getAll("statuses").map(s => parseInt(s));

			const payload = {
				sportNameDescFuzzy: formData.get("sportNameDescFuzzy") || null,
				sportLevel: formData.get("sportLevel") || null,
				createStartDate: formData.get("createStartDate") || null,
				createEndDate: formData.get("createEndDate") || null,
				updateStartDate: formData.get("updateStartDate") || null,
				updateEndDate: formData.get("updateEndDate") || null,
				statuses: statuses
			};

			console.log("é€å‡ºæŸ¥è©¢åƒæ•¸:", payload);

			try {
				let res = await fetch(window.location.origin + "/sport/api/getByComplexCondition", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify(payload)
				});

				let data = await res.json();
				console.log("è¤‡åˆæŸ¥è©¢çµæœ:", data);
				resultEl.textContent = JSON.stringify(data, null, 2);
			} catch (err) {
				console.error("æŸ¥è©¢å¤±æ•—", err);
				resultEl.textContent = "æŸ¥è©¢å¤±æ•—: " + err;
			}
		});
	</script>
</body>
</html>
